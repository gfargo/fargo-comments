# Project Structure

## Root Directory Layout

```
├── app/                     # Next.js App Router
├── components/              # Shared UI components (shadcn/ui)
├── lib/                     # Core library code
├── registry/                # Generated component registry
├── scripts/                 # Build and maintenance scripts
├── public/                  # Static assets
└── styles/                  # Global styles
```

## App Directory (`app/`)
- **`_demo/`**: Demo components and sample data (excluded from registry)
- **`api/`**: API routes for registry and templates
- **`composer/`**, **`threads/`**: Demo pages
- **`globals.css`**: Global styles and Tailwind imports
- **`layout.tsx`**: Root layout with providers

## Components (`components/`)
- **`ui/`**: shadcn/ui components (Button, Card, Dialog, etc.)
- **`theme-provider.tsx`**: Theme context provider
- **`open-in-v0-button.tsx`**: Utility component

## Core Library (`lib/`)

### Comments System (`lib/comments/`)
The main commenting system follows a modular architecture:

- **`adapters/`**: Storage adapter implementations
  - `comment-storage-adapter.ts`: Base interface
  - `local-storage-adapter.ts`: Browser storage
  - `server-action-adapter.ts`: Next.js Server Actions
  - `tanstack-query-adapter.ts`: React Query integration
  - `api-adapter.ts`: REST API integration

- **`components/`**: React components
  - `comments/`: High-level comment components
    - `comment-list.tsx`: Main listing component
    - `comment-search.tsx`: Search and filtering
    - `comment-drawer.tsx`: Sidebar component
    - `variants/`: 12+ design variants
  - `lexical/`: Rich text editor components
    - `lexical-comment-composer.tsx`: Main editor
    - `plugins/`: Auto-lists, emoji, mentions
    - `utils/`: Editor utilities

- **`contexts/`**: React Context providers
  - `comment-context.tsx`: Central state management
  - `mention-context.tsx`: @mentions and #tags data

- **`hooks/`**: Custom React hooks
- **`types/`**: TypeScript definitions
- **`reducers/`**: State management logic
- **`utils/`**: Utility functions

## Registry System (`registry/`)
- **`r/`**: Component definitions (JSON files)
- **`registry.json`**: Registry manifest
- Generated by `scripts/gen-registry.mjs`

## Scripts (`scripts/`)
- **`registry.config.mjs`**: Registry configuration
- **`gen-registry.mjs`**: Registry generator
- **`sync-registry-deps.mjs`**: Dependency synchronization

## Naming Conventions

### Files
- **Components**: PascalCase for React components (`CommentList.tsx`)
- **Utilities**: camelCase for utility files (`formatTimeAgo.ts`)
- **Types**: camelCase for type definition files (`comments.ts`)
- **Configs**: kebab-case for configuration files (`registry.config.mjs`)

### Components
- **Registry Names**: Prefixed with `fargo-comments-` (e.g., `fargo-comments-core`)
- **Component Variants**: Descriptive names (card, bubble, timeline, github, etc.)
- **Adapters**: Suffixed with `-adapter` (e.g., `server-action-adapter`)

### Directories
- **Core System**: All under `lib/comments/` for registry distribution
- **Demo Code**: Under `app/_demo/` (excluded from registry)
- **UI Components**: Under `components/ui/` (shadcn/ui pattern)

## Import Patterns
- Use `@/` alias for all internal imports
- Relative imports within the same directory group
- Barrel exports in `index.ts` files for clean imports

## File Organization Principles
- **Separation of Concerns**: Adapters, components, contexts, hooks in separate directories
- **Registry-Ready**: Core system organized for component registry distribution
- **Demo Isolation**: Demo code clearly separated and excluded from registry
- **Modular Architecture**: Each feature can be imported independently